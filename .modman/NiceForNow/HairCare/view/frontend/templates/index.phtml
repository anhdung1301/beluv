<?php
/**
 * @var  \NiceForNow\HairCare\Block\Index $block
 */
$getCondition = $block->getCondition();
$getSubCondition = $block->getSubConditionByID();
$getPostCollection = $block->getPostCollection();
?>


<style>
    .form-result {
        display: flex;
        justify-items: center;
    }

    .form-result .block-form {
        width: calc(100% / 3);
    }

    .form-result .big-title {
        border: 1px solid #ddd;
        border-right: 0;
        padding: 10px;
    }

    .form-result .block-form:last-child .big-title {
        border-right: 1px solid #ddd;
    }

    .form-result .content {
        border: 1px solid #ddd;
        border-right: 0;
        border-top: 0;
        height: 100%;
        padding: 10px;
        padding-top: 0;
    }

    .form-result .content h4 {
        margin: 0;
        padding-bottom: 10px;
        padding-top: 25px;

    }

    .form-result .block-form:last-child .content {
        border-right: 1px solid #ddd;
    }

</style>
<form id="form" name="form" method="post">
    <div id="condition">
        <label for=1">Condition 1</label>
        <select name="condition1" id="condition1" class="target" id="condition1">
            <option><?= "please choose conditon" ?></option>
            <?php foreach ($getCondition as $select) {
    ?>
                <option class="option" value="<?= $select['condition_id']; ?>"><?= $select['name']; ?></option>";
                <?php
}
            ?>
        </select>
    </div>
    <div id="sub"></div>

</form>
<div class="form-result">
    <?php foreach ($getPostCollection as $type => $item): ?>
        <div style="display: block" class="block-form">
            <div class="big-title"><?= $block->getType($type) ?></div>
            <div class="content">

                <?php foreach ($item as $idx => $subitem): ?>
                    <?php if ($idx == 0): ?>
                        <h4><?= $subitem['title'] ?></h4><?= $subitem['description'] ?>
                    <?php else: ?>
                        <h4><?= $subitem['title'] ?></h4><?= $subitem['description'] ?>
                    <?php endif; ?>
                <?php endforeach; ?>
            </div>
        </div>
    <?php endforeach; ?>
</div>

<script>
    require(["jquery"], function ($) {

        $(".target").change(function () {
            var value = $("#condition1").val();
            var url = "<?= $block->getUrl('haircare/index/getajax')?>";
            $.ajax({
                type: "POST",
                url: url,
                dataType: "json",
                data: {
                    id: value
                },
                success: function (data) {
                    var a = `<label for=1">Condition 2 </label>
                     <select name="condition2" id="condition2" class="form-control">
                       `;

                    $.each(data, function (idx, value) {
                        a += `<option value="${value['sub_id']}"> ${value['name']}</option>";`
                    });
                    a += ` </select>
                    <input type="submit" name="submit" value="Submit">
`;
                    $('#sub').html(a);

                },
                error: function () {
                }
            });

        });
    })
</script>